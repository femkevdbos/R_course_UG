<!DOCTYPE html>
<html>
<head>
  <title>Lecture 7</title>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="generator" content="pandoc" />




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <base target="_blank">

  <script type="text/javascript">
    var SLIDE_CONFIG = {
      // Slide settings
      settings: {
                title: 'Lecture 7',
                        useBuilds: true,
        usePrettify: true,
        enableSlideAreas: true,
        enableTouch: true,
                        favIcon: 'Lecture_week_7_files/logo.png',
              },

      // Author information
      presenters: [
            {
        name:  'More on Data Modelling' ,
        company: '',
        gplus: '',
        twitter: '',
        www: '',
        github: ''
      },
            ]
    };
  </script>

  <script src="Lecture_week_7_files/header-attrs-2.20/header-attrs.js"></script>
  <link href="Lecture_week_7_files/ioslides-13.5.1/fonts/fonts.css" rel="stylesheet" />
  <link href="Lecture_week_7_files/ioslides-13.5.1/theme/css/default.css" rel="stylesheet" />
  <link href="Lecture_week_7_files/ioslides-13.5.1/theme/css/phone.css" rel="stylesheet" />
  <script src="Lecture_week_7_files/ioslides-13.5.1/js/modernizr.custom.45394.js"></script>
  <script src="Lecture_week_7_files/ioslides-13.5.1/js/prettify/prettify.js"></script>
  <script src="Lecture_week_7_files/ioslides-13.5.1/js/prettify/lang-r.js"></script>
  <script src="Lecture_week_7_files/ioslides-13.5.1/js/prettify/lang-yaml.js"></script>
  <script src="Lecture_week_7_files/ioslides-13.5.1/js/hammer.js"></script>
  <script src="Lecture_week_7_files/ioslides-13.5.1/js/slide-controller.js"></script>
  <script src="Lecture_week_7_files/ioslides-13.5.1/js/slide-deck.js"></script>

  <style type="text/css">

    b, strong {
      font-weight: bold;
    }

    em {
      font-style: italic;
    }

    summary {
      display: list-item;
    }

    details > summary > p:only-child {
      display: inline;
    }

    slides > slide {
      -webkit-transition: all 0.2s ease-in-out;
      -moz-transition: all 0.2s ease-in-out;
      -o-transition: all 0.2s ease-in-out;
      transition: all 0.2s ease-in-out;
    }

    .auto-fadein {
      -webkit-transition: opacity 0.6s ease-in;
      -webkit-transition-delay: 0.2s;
      -moz-transition: opacity 0.6s ease-in 0.2s;
      -o-transition: opacity 0.6s ease-in 0.2s;
      transition: opacity 0.6s ease-in 0.2s;
      opacity: 0;
    }
/* https://github.com/ropensci/plotly/pull/524#issuecomment-468142578 */
slide:not(.current) .plotly.html-widget{
  display: block;
}

    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
            pre > code.sourceCode { white-space: pre; position: relative; }
            pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
            pre > code.sourceCode > span:empty { height: 1.2em; }
            .sourceCode { overflow: visible; }
            code.sourceCode > span { color: inherit; text-decoration: inherit; }
            div.sourceCode { margin: 1em 0; }
            pre.sourceCode { margin: 0; }
            @media screen {
            div.sourceCode { overflow: auto; }
            }
            @media print {
            pre > code.sourceCode { white-space: pre-wrap; }
            pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
            }
            pre.numberSource code
              { counter-reset: source-line 0; }
            pre.numberSource code > span
              { position: relative; left: -4em; counter-increment: source-line; }
            pre.numberSource code > span > a:first-child::before
              { content: counter(source-line);
                position: relative; left: -1em; text-align: right; vertical-align: baseline;
                border: none; display: inline-block;
                -webkit-touch-callout: none; -webkit-user-select: none;
                -khtml-user-select: none; -moz-user-select: none;
                -ms-user-select: none; user-select: none;
                padding: 0 4px; width: 4em;
                color: #aaaaaa;
              }
            pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
            div.sourceCode
              {   }
            @media screen {
            pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
            }
            code span.al { color: #ff0000; font-weight: bold; } /* Alert */
            code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
            code span.at { color: #7d9029; } /* Attribute */
            code span.bn { color: #40a070; } /* BaseN */
            code span.bu { color: #008000; } /* BuiltIn */
            code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
            code span.ch { color: #4070a0; } /* Char */
            code span.cn { color: #880000; } /* Constant */
            code span.co { color: #60a0b0; font-style: italic; } /* Comment */
            code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
            code span.do { color: #ba2121; font-style: italic; } /* Documentation */
            code span.dt { color: #902000; } /* DataType */
            code span.dv { color: #40a070; } /* DecVal */
            code span.er { color: #ff0000; font-weight: bold; } /* Error */
            code span.ex { } /* Extension */
            code span.fl { color: #40a070; } /* Float */
            code span.fu { color: #06287e; } /* Function */
            code span.im { color: #008000; font-weight: bold; } /* Import */
            code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
            code span.kw { color: #007020; font-weight: bold; } /* Keyword */
            code span.op { color: #666666; } /* Operator */
            code span.ot { color: #007020; } /* Other */
            code span.pp { color: #bc7a00; } /* Preprocessor */
            code span.sc { color: #4070a0; } /* SpecialChar */
            code span.ss { color: #bb6688; } /* SpecialString */
            code span.st { color: #4070a0; } /* String */
            code span.va { color: #19177c; } /* Variable */
            code span.vs { color: #4070a0; } /* VerbatimString */
            code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
        
    slides > slide:not(.nobackground):before {
      font-size: 12pt;
      content: "";
      position: absolute;
      bottom: 20px;
      left: 60px;
      background: url(Lecture_week_7_files/logo.png) no-repeat 0 50%;
      -webkit-background-size: 30px 30px;
      -moz-background-size: 30px 30px;
      -o-background-size: 30px 30px;
      background-size: 30px 30px;
      padding-left: 40px;
      height: 30px;
      line-height: 1.9;
    }
  </style>


</head>

<body style="opacity: 0">

<slides>

  <slide class="title-slide segue nobackground">
        <aside class="gdbar"><img src="Lecture_week_7_files/logo.png"></aside>
        <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      
      <p data-config-presenter><!-- populated from slide_config.json --></p>
            <p style="margin-top: 6px; margin-left: -2px;">17-10-2023</p>
          </hgroup>
  </slide>

<slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Recap of Last Week</h2></hgroup><article  id="recap-of-last-week" class="smaller ">

</article></slide><slide class=""><hgroup><h2>Recap Lecture 6</h2></hgroup><article  id="recap-lecture-6" class="smaller ">

<ul>
<li>Introduction into Data Modelling</li>
<li>Simple Linear Regression</li>
<li>Assumptions of Linear Regressions</li>
<li>Correlation versus Causation</li>
</ul>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Outline of Lecture 7</h2></hgroup><article  id="outline-of-lecture-7" class="smaller ">

</article></slide><slide class=""><hgroup><h2>Outline of Lecture 7</h2></hgroup><article  id="outline-of-lecture-7-1" class="smaller ">

<ul>
<li>Categorical Variable Linear Regression</li>
<li>Multiple Regression</li>
<li>Logit Model</li>
<li>Bootstrapping</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Steps of Data Analysis</h2></hgroup><article  id="steps-of-data-analysis" class="smaller ">

<center>

<img src="figures/programming_steps.png" alt="HTML5 Icon" width = 95%>

</center>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Categorical Variable Linear Regression</h2></hgroup><article  id="categorical-variable-linear-regression" class="smaller ">

</article></slide><slide class=""><hgroup><h2>Load Data</h2></hgroup><article  id="load-data" class="smaller ">

<pre class = 'prettyprint lang-r'># Load data
library(gapminder)

# Explore data
glimpse(gapminder)</pre>

<pre >## Rows: 1,704
## Columns: 6
## $ country   &lt;fct&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, …
## $ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, …
## $ year      &lt;int&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992, 1997, …
## $ lifeExp   &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.854, 40.8…
## $ pop       &lt;int&gt; 8425333, 9240934, 10267083, 11537966, 13079460, 14880372, 12…
## $ gdpPercap &lt;dbl&gt; 779.4453, 820.8530, 853.1007, 836.1971, 739.9811, 786.1134, …</pre>

</article></slide><slide class=""><hgroup><h2>Select 2007</h2></hgroup><article  id="select-2007" class="smaller ">

<pre class = 'prettyprint lang-r'>gapminder2007 &lt;- gapminder %&gt;%
  filter(year == 2007) %&gt;%
  select(country, lifeExp, continent, gdpPercap)

head(gapminder2007, 5)</pre>

<pre >## # A tibble: 5 × 4
##   country     lifeExp continent gdpPercap
##   &lt;fct&gt;         &lt;dbl&gt; &lt;fct&gt;         &lt;dbl&gt;
## 1 Afghanistan    43.8 Asia           975.
## 2 Albania        76.4 Europe        5937.
## 3 Algeria        72.3 Africa        6223.
## 4 Angola         42.7 Africa        4797.
## 5 Argentina      75.3 Americas     12779.</pre>

</article></slide><slide class=""><hgroup><h2>Visualize - Histogram</h2></hgroup><article  id="visualize---histogram" class="smaller ">

<pre class = 'prettyprint lang-r'>histogram &lt;- ggplot(gapminder2007, aes(x = lifeExp)) +
  geom_histogram(binwidth = 5, color = &quot;white&quot;) +
  labs(x = &quot;Life expectancy&quot;, y = &quot;Number of countries&quot;,
       title = &quot;Histogram of distribution of worldwide life expectancies&quot;) +
  theme_classic()</pre>

</article></slide><slide class=""><hgroup><h2>Visualize - Histogram</h2></hgroup><article  id="visualize---histogram-1" class="smaller ">

<pre class = 'prettyprint lang-r'>histogram </pre>

<p><img src="Lecture_week_7_files/figure-html/unnamed-chunk-4-1.png" width="720" /></p>

</article></slide><slide class=""><hgroup><h2>Histogram per Continent</h2></hgroup><article  id="histogram-per-continent" class="smaller ">

<pre class = 'prettyprint lang-r'>histogram_continent &lt;- ggplot(gapminder2007, aes(x = lifeExp)) +
  geom_histogram(binwidth = 5, color = &quot;white&quot;) +
  labs(x = &quot;Life expectancy&quot;, 
       y = &quot;Number of countries&quot;,
       title = &quot;Histogram of distribution of worldwide life expectancies&quot;) +
  theme_light() +
  facet_wrap(~ continent, nrow = 2) </pre>

</article></slide><slide class=""><hgroup><h2>Histogram per Continent</h2></hgroup><article  id="histogram-per-continent-1" class="smaller ">

<pre class = 'prettyprint lang-r'>histogram_continent</pre>

<p><img src="Lecture_week_7_files/figure-html/unnamed-chunk-6-1.png" width="720" /></p>

</article></slide><slide class=""><hgroup><h2>Boxplot per Continent</h2></hgroup><article  id="boxplot-per-continent" class="smaller ">

<pre class = 'prettyprint lang-r'>boxplot_continent &lt;- ggplot(gapminder2007, aes(x = continent, y = lifeExp)) +
  geom_boxplot() +
  labs(x = &quot;Continent&quot;, y = &quot;Life expectancy&quot;,
       title = &quot;Life expectancy by continent&quot;) +
  theme_minimal()</pre>

</article></slide><slide class=""><hgroup><h2>Boxplot per Continent</h2></hgroup><article  id="boxplot-per-continent-1" class="smaller ">

<pre class = 'prettyprint lang-r'>boxplot_continent </pre>

<p><img src="Lecture_week_7_files/figure-html/unnamed-chunk-8-1.png" width="720" /></p>

</article></slide><slide class=""><hgroup><h2>Exploratory Data Analysis</h2></hgroup><article  id="exploratory-data-analysis" class="smaller ">

<pre class = 'prettyprint lang-r'>lifeExp_by_continent &lt;- gapminder2007 %&gt;%
  group_by(continent) %&gt;%
  summarize(median = median(lifeExp), 
            mean = mean(lifeExp))

lifeExp_by_continent</pre>

<pre >## # A tibble: 5 × 3
##   continent median  mean
##   &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt;
## 1 Africa      52.9  54.8
## 2 Americas    72.9  73.6
## 3 Asia        72.4  70.7
## 4 Europe      78.6  77.6
## 5 Oceania     80.7  80.7</pre>

</article></slide><slide class=""><hgroup><h2>Linear Regression</h2></hgroup><article  id="linear-regression" class="smaller ">

<pre class = 'prettyprint lang-r'>lifeExp_model &lt;- lm(lifeExp ~ continent, data = gapminder2007)
summary(lifeExp_model)</pre>

<pre >## 
## Call:
## lm(formula = lifeExp ~ continent, data = gapminder2007)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -26.9005  -4.0399   0.2565   3.3840  21.6360 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         54.806      1.025  53.446  &lt; 2e-16 ***
## continentAmericas   18.802      1.800  10.448  &lt; 2e-16 ***
## continentAsia       15.922      1.646   9.675  &lt; 2e-16 ***
## continentEurope     22.843      1.695  13.474  &lt; 2e-16 ***
## continentOceania    25.913      5.328   4.863 3.12e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.395 on 137 degrees of freedom
## Multiple R-squared:  0.6355, Adjusted R-squared:  0.6249 
## F-statistic: 59.71 on 4 and 137 DF,  p-value: &lt; 2.2e-16</pre>

</article></slide><slide class=""><hgroup><h2>Regression Table</h2></hgroup><article  id="regression-table" class="smaller ">

<pre class = 'prettyprint lang-r'>get_regression_table(lifeExp_model)</pre>

<pre >## # A tibble: 5 × 7
##   term                estimate std_error statistic p_value lower_ci upper_ci
##   &lt;chr&gt;                  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 intercept               54.8      1.02     53.4        0     52.8     56.8
## 2 continent: Americas     18.8      1.8      10.4        0     15.2     22.4
## 3 continent: Asia         15.9      1.65      9.68       0     12.7     19.2
## 4 continent: Europe       22.8      1.70     13.5        0     19.5     26.2
## 5 continent: Oceania      25.9      5.33      4.86       0     15.4     36.4</pre>

</article></slide><slide class=""><hgroup><h2>Fitted Values and Residuals</h2></hgroup><article  id="fitted-values-and-residuals" class="smaller ">

<pre class = 'prettyprint lang-r'>regression_points &lt;- get_regression_points(lifeExp_model, ID = &quot;country&quot;)
head(regression_points, 5)</pre>

<pre >## # A tibble: 5 × 5
##   country     lifeExp continent lifeExp_hat residual
##   &lt;fct&gt;         &lt;dbl&gt; &lt;fct&gt;           &lt;dbl&gt;    &lt;dbl&gt;
## 1 Afghanistan    43.8 Asia             70.7   -26.9 
## 2 Albania        76.4 Europe           77.6    -1.23
## 3 Algeria        72.3 Africa           54.8    17.5 
## 4 Angola         42.7 Africa           54.8   -12.1 
## 5 Argentina      75.3 Americas         73.6     1.71</pre>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Multiple Regression</h2></hgroup><article  id="multiple-regression" class="smaller ">

</article></slide><slide class=""><hgroup><h2>Use the US Arrests data</h2></hgroup><article  id="use-the-us-arrests-data" class="smaller ">

<pre class = 'prettyprint lang-r'># Load the USArrests dataset
data(USArrests)

# View the first few rows of the dataset to understand its structure
head(USArrests)</pre>

<pre >##            Murder Assault UrbanPop Rape
## Alabama      13.2     236       58 21.2
## Alaska       10.0     263       48 44.5
## Arizona       8.1     294       80 31.0
## Arkansas      8.8     190       50 19.5
## California    9.0     276       91 40.6
## Colorado      7.9     204       78 38.7</pre>

</article></slide><slide class=""><hgroup><h2>Fit a Multiple Regression Model</h2></hgroup><article  id="fit-a-multiple-regression-model" class="smaller ">

<pre class = 'prettyprint lang-r'># Fit a multiple regression model with &quot;Murder&quot; as the dependent variable
# and other variables as predictors
murder_model &lt;- lm(Murder ~ Assault + UrbanPop + Rape, data = USArrests)

# Print the summary of the regression model
summary(murder_model)</pre>

<pre >## 
## Call:
## lm(formula = Murder ~ Assault + UrbanPop + Rape, data = USArrests)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.3990 -1.9127 -0.3444  1.2557  7.4279 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.276639   1.737997   1.885   0.0657 .  
## Assault      0.039777   0.005912   6.729 2.33e-08 ***
## UrbanPop    -0.054694   0.027880  -1.962   0.0559 .  
## Rape         0.061399   0.055740   1.102   0.2764    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.574 on 46 degrees of freedom
## Multiple R-squared:  0.6721, Adjusted R-squared:  0.6507 
## F-statistic: 31.42 on 3 and 46 DF,  p-value: 3.322e-11</pre>

</article></slide><slide class=""><hgroup><h2>Test for Multicollinearity - Correlation Matrix</h2></hgroup><article  id="test-for-multicollinearity---correlation-matrix" class="smaller ">

<pre class = 'prettyprint lang-r'># Create a correlation matrix
cor(USArrests)</pre>

<pre >##              Murder   Assault   UrbanPop      Rape
## Murder   1.00000000 0.8018733 0.06957262 0.5635788
## Assault  0.80187331 1.0000000 0.25887170 0.6652412
## UrbanPop 0.06957262 0.2588717 1.00000000 0.4113412
## Rape     0.56357883 0.6652412 0.41134124 1.0000000</pre>

<pre class = 'prettyprint lang-r'># Interpret the results:
# Values close to 1 or -1 suggest high correlation</pre>

</article></slide><slide class=""><hgroup><h2>Test for Multicollinearity - Scatterplots</h2></hgroup><article  id="test-for-multicollinearity---scatterplots" class="smaller ">

<pre class = 'prettyprint lang-r'># Create scatterplots
# You can choose which pairs of variables you want to plot
plot(USArrests$Rape, USArrests$Assault, 
     xlab = &quot;Rape&quot;, ylab = &quot;Assault&quot;,
     main = &quot;Scatterplot of Rape vs. Assault&quot;)</pre>

<p><img src="Lecture_week_7_files/figure-html/unnamed-chunk-16-1.png" width="720" /></p>

</article></slide><slide class=""><hgroup><h2>Test for Multicollinearity - VIF</h2></hgroup><article  id="test-for-multicollinearity---vif" class="smaller ">

<pre class = 'prettyprint lang-r'>library(car)

# Calculate VIF for the model
vif(murder_model)</pre>

<pre >##  Assault UrbanPop     Rape 
## 1.794715 1.204229 2.015462</pre>

<pre class = 'prettyprint lang-r'># Interpret the results:
# High VIF values suggest potential multicollinearity.</pre>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Interaction Terms</h2></hgroup><article  id="interaction-terms" class="smaller ">

</article></slide><slide class=""><hgroup><h2>Multiple Regression with Interaction Terms</h2></hgroup><article  id="multiple-regression-with-interaction-terms" class="smaller ">

<pre class = 'prettyprint lang-r'># Fit a multiple regression model with the Diet and Time interaction
chickweight_model &lt;- lm(weight ~ Time * Diet, data = ChickWeight)</pre>

</article></slide><slide class=""><hgroup><h2>Multiple Regression with Interaction Terms</h2></hgroup><article  id="multiple-regression-with-interaction-terms-1" class="smaller ">

<pre class = 'prettyprint lang-r'># Summary of the model
summary(chickweight_model)</pre>

<pre >## 
## Call:
## lm(formula = weight ~ Time * Diet, data = ChickWeight)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -135.425  -13.757   -1.311   11.069  130.391 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  30.9310     4.2468   7.283 1.09e-12 ***
## Time          6.8418     0.3408  20.076  &lt; 2e-16 ***
## Diet2        -2.2974     7.2672  -0.316  0.75202    
## Diet3       -12.6807     7.2672  -1.745  0.08154 .  
## Diet4        -0.1389     7.2865  -0.019  0.98480    
## Time:Diet2    1.7673     0.5717   3.092  0.00209 ** 
## Time:Diet3    4.5811     0.5717   8.014 6.33e-15 ***
## Time:Diet4    2.8726     0.5781   4.969 8.92e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 34.07 on 570 degrees of freedom
## Multiple R-squared:  0.773,  Adjusted R-squared:  0.7702 
## F-statistic: 277.3 on 7 and 570 DF,  p-value: &lt; 2.2e-16</pre>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Logit</h2></hgroup><article  id="logit" class="smaller ">

</article></slide><slide class=""><hgroup><h2>Introduction to the Logit Model</h2></hgroup><article  id="introduction-to-the-logit-model" class="smaller ">

<ul>
<li>Binary dependent variable</li>
<li>Use the logistic function to estimate \(P(Y = 1)\)</li>
<li>\(p(Y = 1) = \frac{1}{1 + e^{-(\beta_0 + \beta_1X_1 + \beta_2X_2 + \ldots + \beta_pX_p)}}\)</li>
<li>Log-odds ratio: \(\log\left(\frac{p(Y = 1)}{1 - p(Y = 1)}\right) = \beta_0 + \beta_1X_1 + \beta_2X_2 + \ldots + \beta_pX_p\)</li>
<li>Hence \(exp(\beta_j)\) is the change in the odds of the event happening for a one-unit increase in \(X_j\)</li>
</ul>

<p>Example: - 50/50 chance: odds = 1 - 80/20 chance: odds = 0.8/0.2 = 4 - 4 times more chance of yes than no - The odds of passing is 4 (to 1)</p>

</article></slide><slide class=""><hgroup><h2>Introduction to the Logit Model</h2></hgroup><article  id="introduction-to-the-logit-model-1" class="smaller ">

<p>Example: \[
\log\left(\frac{p(\text{Pass} = 1)}{1-p(\text{Pass} = 1)}\right) = \beta_0 + \beta_1 \cdot \text{Hours_Studied} + \epsilon
\]</p>

<ul>
<li><p>Odds ratio: the ratio of two odds</p></li>
<li><p>With the logit model we calculate how X variables affect the odds ratio \[
\text{Odds Ratio} = \frac{\text{Odds of passing with 3 hrs of study}}{\text{Odds of passing with 2 hrs of study}} = \frac{0.6/0.4}{0.5/0.5} = \frac{1.5}{1} = 1.5
\]</p></li>
<li><p>If \(exp(\beta_1) = 1.5\), then for one hour increase in study time, the <strong>odds</strong> of passing the exam increase by 50%.</p></li>
<li><p>This does NOT mean the chance of passing increases by 50%, as that only increased from 50% to 60%!</p></li>
</ul>

</article></slide><slide class=""><hgroup><h2>Diabetes Data</h2></hgroup><article  id="diabetes-data" class="smaller ">

<pre class = 'prettyprint lang-r'># Install and load the &quot;MASS&quot; package (if not already installed)
# install.packages(&quot;MASS&quot;)
library(MASS)

# Load the Pima Indians Diabetes dataset
data(Pima.te)

# Inspect the data
glimpse(Pima.te)</pre>

<pre >## Rows: 332
## Columns: 8
## $ npreg &lt;int&gt; 6, 1, 1, 3, 2, 5, 0, 1, 3, 9, 1, 5, 3, 10, 4, 9, 2, 4, 3, 7, 9, …
## $ glu   &lt;int&gt; 148, 85, 89, 78, 197, 166, 118, 103, 126, 119, 97, 109, 88, 122,…
## $ bp    &lt;int&gt; 72, 66, 66, 50, 70, 72, 84, 30, 88, 80, 66, 75, 58, 78, 60, 76, …
## $ skin  &lt;int&gt; 35, 29, 23, 32, 45, 19, 47, 38, 41, 35, 15, 26, 11, 31, 33, 37, …
## $ bmi   &lt;dbl&gt; 33.6, 26.6, 28.1, 31.0, 30.5, 25.8, 45.8, 43.3, 39.3, 29.0, 23.2…
## $ ped   &lt;dbl&gt; 0.627, 0.351, 0.167, 0.248, 0.158, 0.587, 0.551, 0.183, 0.704, 0…
## $ age   &lt;int&gt; 50, 31, 21, 26, 53, 51, 31, 33, 27, 29, 22, 60, 22, 45, 33, 46, …
## $ type  &lt;fct&gt; Yes, No, No, Yes, Yes, Yes, Yes, No, No, Yes, No, No, No, No, No…</pre>

</article></slide><slide class=""><hgroup><h2>Logit Model in R</h2></hgroup><article  id="logit-model-in-r" class="smaller ">

<pre class = 'prettyprint lang-r'># Fit a logistic regression model (could also use probit)
diabetes_model &lt;- glm(type ~ glu + age + bmi, data = Pima.tr, 
                      family = binomial(link = &quot;logit&quot;))

# Summary of the model
summary(diabetes_model)</pre>

<pre >## 
## Call:
## glm(formula = type ~ glu + age + bmi, family = binomial(link = &quot;logit&quot;), 
##     data = Pima.tr)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2356  -0.6974  -0.3967   0.6956   2.3878  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -9.405120   1.477177  -6.367 1.93e-10 ***
## glu          0.030850   0.006448   4.784 1.72e-06 ***
## age          0.052569   0.016970   3.098  0.00195 ** 
## bmi          0.091871   0.032242   2.849  0.00438 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 256.41  on 199  degrees of freedom
## Residual deviance: 188.39  on 196  degrees of freedom
## AIC: 196.39
## 
## Number of Fisher Scoring iterations: 5</pre>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Boostrapping</h2></hgroup><article  id="boostrapping" class="smaller ">

</article></slide><slide class=""><hgroup><h2>Assumptions in Regression Analysis</h2></hgroup><article  id="assumptions-in-regression-analysis" class="smaller ">

<ul>
<li>When using <code>lm()</code> R assumes that the assumptions for a linear regression model hold</li>
<li>What if they don’t hold?

<ul>
<li>Has been discussed in the last lecture, different solutions</li>
</ul></li>
<li>Normally distributed errors = essential for statistical inference</li>
<li>More popular now = non-parametric methods</li>
<li>Non-parametric methods = no assumptions on distribution of error</li>
<li>Very good to include as a robustness check!

<ul>
<li>Checks whether results are robust to the assumptions on the error term</li>
</ul></li>
</ul>

</article></slide><slide class=""><hgroup><h2>Introduction into Bootstrapping</h2></hgroup><article  id="introduction-into-bootstrapping" class="smaller ">

<ul>
<li>A resampling technique to estimate the variability of regression coefficients</li>
<li>Assesses the robustness of your regression model</li>
<li>A very popular and good robustness check</li>
<li>If we had a random resampled collection of your datapoints,:

<ul>
<li>Would your coefficients still be significant?</li>
</ul></li>
<li>Resampling from the data to estimate the regression coefficients multiple times.</li>
<li>Central assumption for bootstrapping = The original sample accurately represents the actual population</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Back to the US Arrests data</h2></hgroup><article  id="back-to-the-us-arrests-data" class="smaller ">

<pre class = 'prettyprint lang-r'># Fit a linear multiple regression model
murder_model &lt;- lm(Murder ~ Assault + UrbanPop + Rape, data = USArrests)

# Summary of the lm model
summary(murder_model)</pre>

<pre >## 
## Call:
## lm(formula = Murder ~ Assault + UrbanPop + Rape, data = USArrests)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.3990 -1.9127 -0.3444  1.2557  7.4279 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.276639   1.737997   1.885   0.0657 .  
## Assault      0.039777   0.005912   6.729 2.33e-08 ***
## UrbanPop    -0.054694   0.027880  -1.962   0.0559 .  
## Rape         0.061399   0.055740   1.102   0.2764    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.574 on 46 degrees of freedom
## Multiple R-squared:  0.6721, Adjusted R-squared:  0.6507 
## F-statistic: 31.42 on 3 and 46 DF,  p-value: 3.322e-11</pre>

</article></slide><slide class=""><hgroup><h2>Initialize before Boostrapping</h2></hgroup><article  id="initialize-before-boostrapping" class="smaller ">

<pre class = 'prettyprint lang-r'># Set seed for reproducibility
set.seed(2023)

# Number of bootstraps
n_bootstraps &lt;- 1000

# Initialize storage for bootstrapped coefficients
bootstrapped_coefs &lt;- data.frame(&quot;Intercept&quot; = rep(0, n_bootstraps),
                                 &quot;Assault&quot; = rep(0, n_bootstraps), 
                                 &quot;UrbanPop&quot; = rep(0, n_bootstraps),
                                 &quot;Rape&quot; = rep(0, n_bootstraps))</pre>

</article></slide><slide class=""><hgroup><h2>Perform Boostrapping</h2></hgroup><article  id="perform-boostrapping" class="smaller ">

<pre class = 'prettyprint lang-r'># Perform bootstrapping
for (i in 1:n_bootstraps) {
  # Resample the dataset
  resampled_data &lt;- USArrests[sample(nrow(USArrests), replace = TRUE), ]
  
  # Fit a regression model to the resampled data
  resampled_model &lt;- lm(Murder ~ Assault + UrbanPop + Rape, 
                        data = resampled_data)
  
  # Store the coefficients
  bootstrapped_coefs[i, ] &lt;- coef(resampled_model)
}</pre>

</article></slide><slide class=""><hgroup><h2>Visualize Boostrapping</h2></hgroup><article  id="visualize-boostrapping" class="smaller ">

<pre class = 'prettyprint lang-r'># Visualize Bootstrapped Coefficients
# Create a density plot for Temperature coefficient
density_plot_assault &lt;- density(bootstrapped_coefs[, 2])
plot(density_plot_assault, main = &quot;Bootstrapped Coefficient for Assault&quot;)</pre>

<p><img src="Lecture_week_7_files/figure-html/unnamed-chunk-25-1.png" width="720" /></p>

</article></slide><slide class=""><hgroup><h2>Confidence Intervals</h2></hgroup><article  id="confidence-intervals" class="smaller ">

<pre class = 'prettyprint lang-r'># Confidence Intervals
confidence_intervals &lt;- t(sapply(1:4, function(j){
  quantile(bootstrapped_coefs[, j], c(0.025, 0.975))
}))
colnames(confidence_intervals) &lt;- c(&quot;Lower 2.5%&quot;, &quot;Upper 97.5%&quot;)
rownames(confidence_intervals) &lt;- colnames(bootstrapped_coefs)

# Print Confidence Intervals
confidence_intervals</pre>

<pre >##            Lower 2.5%  Upper 97.5%
## Intercept  0.33911949 6.5271506965
## Assault    0.02817434 0.0547426312
## UrbanPop  -0.11341254 0.0002378989
## Rape      -0.05135256 0.2010056714</pre>

</article></slide><slide class=""><hgroup><h2>Assessing Significance with Bootstrapping</h2></hgroup><article  id="assessing-significance-with-bootstrapping" class="smaller ">

<ul>
<li>We’ve performed bootstrapping to estimate the variability of regression coefficients.</li>
<li>But how can we use this information to assess the significance of our results?</li>
<li>Bootstrapping allows us to generate a distribution of coefficients.</li>
<li>We can compare our original regression coefficients to this distribution to assess significance.</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Assessing Significance</h2></hgroup><article  id="assessing-significance" class="smaller ">

<ol>
<li>Calculate the confidence intervals for each coefficient using bootstrapped data.</li>
<li>If the confidence interval of a coefficient includes zero, it suggests that the coefficient is not statistically significant.</li>
<li>If the interval does not include zero, it suggests significance.</li>
</ol>

</article></slide><slide class=""><hgroup><h2>Example: Murder Rate and Predictors</h2></hgroup><article  id="example-murder-rate-and-predictors" class="smaller ">

<pre class = 'prettyprint lang-r'># Lm model confidence intervals
get_regression_table(murder_model)</pre>

<pre >## # A tibble: 4 × 7
##   term      estimate std_error statistic p_value lower_ci upper_ci
##   &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 intercept    3.28      1.74       1.88   0.066   -0.222    6.78 
## 2 Assault      0.04      0.006      6.73   0        0.028    0.052
## 3 UrbanPop    -0.055     0.028     -1.96   0.056   -0.111    0.001
## 4 Rape         0.061     0.056      1.10   0.276   -0.051    0.174</pre>

<pre class = 'prettyprint lang-r'># Bootstrap confidence intervals
confidence_intervals</pre>

<pre >##            Lower 2.5%  Upper 97.5%
## Intercept  0.33911949 6.5271506965
## Assault    0.02817434 0.0547426312
## UrbanPop  -0.11341254 0.0002378989
## Rape      -0.05135256 0.2010056714</pre>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>End of the Course Material</h2></hgroup><article  id="end-of-the-course-material" class="smaller ">

</article></slide><slide class=""><hgroup><h2>Overview</h2></hgroup><article  id="overview" class="smaller ">

<table class = 'rmdtable'>
<tr class="header">
<th align="left">Week</th>
<th align="left">Topic</th>
</tr>
<tr class="odd">
<td align="left"><em>Week 1</em></td>
<td align="left">Introduction to R</td>
</tr>
<tr class="even">
<td align="left"><em>Week 2</em></td>
<td align="left">Foundations of R</td>
</tr>
<tr class="odd">
<td align="left"><em>Week 3</em></td>
<td align="left">Data Wrangling</td>
</tr>
<tr class="even">
<td align="left"><em>Week 4</em></td>
<td align="left">Data Visualization (pt.1)</td>
</tr>
<tr class="odd">
<td align="left"><em>Week 5</em></td>
<td align="left">Data Visualization (pt.2)</td>
</tr>
<tr class="even">
<td align="left"><em>Week 6</em></td>
<td align="left">Introduction into Data Modelling in R</td>
</tr>
<tr class="odd">
<td align="left"><em>Week 7</em></td>
<td align="left">More on Data Modelling</td>
</tr>
<tr class="even">
<td align="left"><em>Extra</em></td>
<td align="left">Time for rescheduling/recap/presentations</td>
</tr>
</table>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>End of Lecture 7</h2></hgroup><article  id="end-of-lecture-7" class="smaller "></article></slide>


  <slide class="backdrop"></slide>

</slides>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!-- map slide visiblity events into shiny -->
<script>
  (function() {
    if (window.jQuery) {
       window.jQuery(document).on('slideleave', function(e) {
         window.jQuery(e.target).trigger('hidden');
      });
       window.jQuery(document).on('slideenter', function(e) {
         window.jQuery(e.target).trigger('shown');
      });
    }
  })();
</script>

</body>
</html>
